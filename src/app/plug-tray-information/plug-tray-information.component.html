<div class="right-scroll">
  <!-- START: Plug Tray Information -->
  <table class="table_one table-width">
    <thead>
      <tr>
        <td>
          <div class="toggle-button-css" *ngIf="mergeClickBool == false">
            <div>
              <mat-form-field class="full-width">
                <input matInput placeholder="Variety" [(ngModel)]="appSharedService.searchFieldValue" [formControl]="varietyControl">
              </mat-form-field>
            </div>
          </div>
          <div class="flex-display" [class.flex-center]="mergeClickBool">
            <button mat-button *ngIf="mergeClickBool == false" (click)="mergeClick($event, 'start_merge')"><i class="material-icons rotate_90">merge_type</i> MERGE</button>
            <button mat-button *ngIf="mergeClickBool == false"><i class="material-icons rotate_90">call_split</i> SPLIT</button>
            <button mat-button *ngIf="mergeClickBool == true" (click)="mergeClick($event, 'cancel_merge')"><i class="material-icons rotate_90">merge_type</i> CANCEL MERGE</button>
          </div>
          <div class="select-plant-text" *ngIf="mergeClickBool == true">Select a plant to merge</div>
          <div class="toggle-button-css" *ngIf="mergeClickBool == false">
            <mat-button-toggle-group #group="matButtonToggleGroup">
              <mat-button-toggle value="left">
                Type <i class="material-icons">arrow_drop_down</i>
              </mat-button-toggle>
              <mat-button-toggle value="center" (click)="appSharedService.varietiesSort()">
                A-Z <i class="material-icons">arrow_drop_down</i>
              </mat-button-toggle>
              <mat-button-toggle value="right" (click)="appSharedService.weekSort()">
                Wk# <i class="material-icons">arrow_drop_down</i>
              </mat-button-toggle>
            </mat-button-toggle-group>
          </div>
        </td>
        <td *ngFor="let head of heads">
          <span><i class="material-icons rotate_90 valign_middle color-grey">arrow_drop_down</i>{{head}}</span>
        </td>
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let item of appSharedService.varietyOptions | SearchVarieties: appSharedService.searchFieldValue; let i =index;" class="form-input-model">
        <td>
          <div [innerHTML]="item['nameHtml']" class="icon-box"></div>
          <span>{{item.name}}</span><span>{{ item.weekNumber ? '  week' + item.weekNumber : ''}}</span>
        </td>
        <td>
          <input matInput name="pfr" type="number" [(ngModel)]="item.plugTray.plugFlatsReceived" (blur)="updatePlugToDeliverData(item, i)">
        </td>
        <td>
          <!-- <input matInput name="date_received" > -->
          <mat-form-field [formGroup]="PlugTrayForm">
            <input matInput [matDatepicker]="picker" (click)="picker.open()" (focus)="picker.open()" [(ngModel)]="item.plugTray.dateReceived"
              formControlName="dateReceived" (dateChange)="calculateWeekNumber($event, item); updatePlugToDeliverData(item, i)">
            <!-- <mat-datepicker-toggle matSuffix [for]="picker"></mat-datepicker-toggle> -->
            <mat-datepicker #picker></mat-datepicker>
          </mat-form-field>
        </td>
        <td>
          <input matInput name="pfp" type="number" [(ngModel)]="item.plugTray.plugFlatsPlotted" (blur)="updatePlugToDeliverData(item, i)">
        </td>
        <td>
          <input matInput name="pfd" type="number" [(ngModel)]="item.plugTray.plugFlatsDiscarded" (blur)="updatePlugToDeliverData(item, i)">
        </td>
        <td>
          <!-- <input matInput name="reason_code" [(ngModel)]="item.reason_code"> -->
          <mat-select placeholder="" #select="matSelect" [disabled]="!item.plugTray.plugFlatsDiscarded" [(ngModel)]="item.plugTray.reasonsCode"
            (ngModelChange)="updatePlugToDeliverData(item, i)">
            <mat-select-trigger>{{select.selected?.viewValue.split(' (')[0]}}</mat-select-trigger>
            <mat-option *ngFor="let rc of reasonCodes" [value]="rc.code">{{ rc.code }} ({{rc.reason}})</mat-option>
          </mat-select>
        </td>
        <td>
          <input matInput name="lot_no" type="text" [(ngModel)]="item.plugTray.seedLotNumber" (blur)="updatePlugToDeliverData(item, i)">
        </td>
      </tr>


      <div class="flex-display add-plant" [class.flex-center]="mergeClickBool" *ngIf="mergeClickBool == false">
        <button mat-button><i class="material-icons rotate_90" style="pointer-events: none">add_circle</i></button>
        <mat-form-field>
          <input type="text" matInput [formControl]="myControl" [(ngModel)]="newPlant" placeholder="New Plug" [matAutocomplete]="plant">
        </mat-form-field>
        <mat-autocomplete #plant="matAutocomplete" [displayWith]="displayFn">
          <mat-option *ngFor="let plant of greenHousePlants" [value]="plant" data-id="plant.id" (onSelectionChange)="addPlant($event, plant)">
            {{ plant.name }}
          </mat-option>
        </mat-autocomplete>
      </div>
    </tbody>
  </table>
  <!-- END: Plug Tray Information -->
</div>
